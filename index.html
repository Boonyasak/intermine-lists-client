<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">

	<title>InterMine > MyMine</title>

    <link rel="stylesheet" type="text/css" href="css/reset.css">
    <link rel="stylesheet" type="text/css" href="css/style.css">

    <script type="text/javascript" src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.6.4.min.js"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js"></script>
</head>
<body>
    <h1>Your Lists</h1>
    <div class="toolbar clearafter">
        <div class="btn folder">
            <span class="label"></span>
            <span class="description">Create a folder</span>
        </div>
        <div class="btn organize" style="display:none;">
            <span class="label"></span>
            <span class="description">Organize lists into a folder</span>
        </div>
        <div class="btn trash">
            <span class="label"></span>
            <span class="description">Trash lists</span>
        </div>
        <div class="btn restore">
            <span class="label"></span>
            <span class="description">Restore trashed lists</span>
        </div>
        <div class="btn tags">
            <span class="label"></span>
            <span class="description">Edit list tags</span>
        </div>
        <div class="btn maths">
            <span class="label"></span>
            <span class="description">Join, subtract, intersect lists</span>
        </div>
        <div class="btn more">More</div>

        <div class="right">
            <div class="btn sort">Sort <span class="description">Sort lists</span></div>
        </div>
    </div>

    <table>
        <thead>
            <tr>
                <th><input type="checkbox" /></th>
                <th>Name</th>
                <th></th>
                <th>Type</th>
                <th>Created</th>
            </tr>
        </thead>
        <tbody>
            <tr class="list">
                <td><input type="checkbox" /></td>
                <td>
                    <span class="type"></span>
                    <div class="name">
                        <a href="#">
                            <h2>Gene list with my rubbish features (26)</h2>
                            <div class="description"><p><strong>Description:</strong> Some description for my list here
                            to say where it comes from etc.</p></div>
                        </a>
                    </div>
                    <div class="tags">
                        <ul>
                            <li><a class="public"><span class="label">public</span></a></li>
                            <li><a><span class="label">frontpage</span></a></li>
                        </ul>
                    </div>
                </td>
                <td><span class="favorite active"><span class="description">Unfavorite this list</span></span></td>
                <td class="type">Genes</td>
                <td class="datetime">6 Aug</td>
            </tr>
            <tr class="folder">
                <td><input type="checkbox" /></td>
                <td>
                    <span class="type"></span>
                    <div class="name">
                        <a href="#">
                            <h2>Human cloning experiment</h2>
                        </a>
                    </div>
                </td>
                <td></td>
                <td></td>
                <td class="datetime">21:57</td>
            </tr>
            <tr class="list">
                <td><input type="checkbox" /></td>
                <td class="foldered">
                    <span class="type"></span>
                    <div class="name">
                        <a href="#">
                            <h2>Another list name this time with no description (91)</h2>
                        </a>
                    </div>
                    <div class="tags">
                        <ul>
                            <li><a class="private"><span class="label">admin</span></a></li>
                            <li><a><span class="label">frontpage</span></a></li>
                        </ul>
                    </div>
                </td>
                <td><span class="favorite"><span class="description">Favorite this list</span></span></td>
                <td class="type">Proteins</td>
                <td class="datetime">15:46</td>
            </tr>
            <tr class="list">
                <td><input type="checkbox" /></td>
                <td class="foldered">
                    <span class="type"></span>
                    <div class="name">
                        <a href="#">
                            <h2>Gene list for all organisms 20 Sep 2011 10.45 (13,576)</h2>
                        </a>
                    </div>
                    <div class="tags">
                        <ul>
                            <li><a><span class="label">order 1</span></a></li>
                        </ul>
                    </div>
                </td>
                <td><span class="favorite"><span class="description">Favorite this list</span></span></td>
                <td class="type">Genes</td>
                <td class="datetime">20 Sep</td>
            </tr>
            <tr class="list">
                <td><input type="checkbox" /></td>
                <td class="foldered">
                    <span class="type"></span>
                    <div class="name">
                        <a href="#">
                            <h2>Gene list for all organisms 20 Sep 2011 10.45dsds (13,575)</h2>
                        </a>
                    </div>
                    <div class="tags">
                        <ul>
                            <li><a class="organic"><span class="label">organic</span></a></li>
                            <li><a><span class="label">order 3</span></a></li>
                        </ul>
                    </div>
                </td>
                <td><span class="favorite"><span class="description">Favorite this list</span></span></td>
                <td class="type">Genes</td>
                <td class="datetime">20 Sep</td>
            </tr>
            <tr class="list">
                <td><input type="checkbox" /></td>
                <td>
                    <span class="type"></span>
                    <div class="name">
                        <a href="#">
                            <h2>FlyTF_site_specific (42)</h2>
                            <div class="description"><p><strong>Description:</strong> Experimentally verified site-specific
                            TFs: Transcription factors with experimental evidence for both DNA-binding and transcriptional
                            regulatory function.</p></div>
                        </a>
                    </div>
                    <div class="tags">
                        <ul>
                            <li><a class="public"><span class="label">public</span></a></li>
                        </ul>
                    </div>
                </td>
                <td><span class="favorite active"><span class="description">Favorite this list</span></span></td>
                <td class="type">TFs</td>
                <td class="datetime">13:25</td>
            </tr>
            <tr class="list">
                <td><input type="checkbox" /></td>
                <td>
                    <span class="type"></span>
                    <div class="name">
                        <a href="#">
                            <h2>PL sperm_proteome_genes (365)</h2>
                            <div class="description"><p><strong>Description:</strong> Genes encoding the D. melanogaster sperm
                            proteome (Source: Dorus et al 2006 - PubMed: 17099233).</p></div>
                        </a>
                    </div>
                    <div class="tags">
                        <ul>
                            <li><a class="public"><span class="label">public</span></a></li>
                        </ul>
                    </div>
                </td>
                <td><span class="favorite"><span class="description">Favorite this list</span></span></td>
                <td class="type">Genes</td>
                <td class="datetime">19 May</td>
            </tr>
        </tbody>
    </table>

    <!-- overlays -->
    <div id="body-overlay">
        <div class="popup folder" style="width:300px">
            <h2>Choose folder name</h2>
            <input type="text" />
            <p>Folders organize your lists, like on a PC.</p>
            <div class="btn close green">Save</div>
            <div class="btn close gray">Cancel</div>
        </div>

        <div class="popup trash" style="width:300px">
            <h2>List trashed</h2>
            <p>If you ever need to restore your list, click on the <strong>restore</strong> button icon:</p>
            <img src="img/restore-list.png" style="display:block;margin:0 auto; margin-top:-10px; margin-bottom:10px;"/>
            <div class="btn close gray">OK, go away</div>
        </div>

        <div class="popup restore" style="width:700px">
            <h2>Restore lists</h2>
            <p>Select any lists you would like to restore.</p>
            <table>
                <thead>
                    <tr>
                        <th><input type="checkbox" /></th>
                        <th>Name</th>
                        <th>Type</th>
                        <th>Created</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><input type="checkbox" /></td>
                        <td class="list">
                            <span class="type"></span>
                            <div class="name">
                                <a href="#">
                                    <h2>Another list name this time with no description (91)</h2>
                                </a>
                            </div>
                        </td>
                        <td class="type">Proteins</td>
                        <td class="datetime">15:46</td>
                    </tr>
                    <tr>
                        <td><input type="checkbox" /></td>
                        <td class="list">
                            <span class="type"></span>
                            <div class="name">
                                <a href="#">
                                    <h2>Gene list for all organisms 20 Sep 2011 10.45 (13,576)</h2>
                                </a>
                            </div>
                        </td>
                        <td class="type">Genes</td>
                        <td class="datetime">20 Sep</td>
                    </tr>
                    <tr>
                        <td><input type="checkbox" /></td>
                        <td class="list">
                            <div class="name">
                                <a href="#">
                                    <h2>Gene list with my rubbish features (26)</h2>
                                    <div class="description"><p><strong>Description:</strong> Some description for my list here
                                    to say where it comes from etc.</p></div>
                                </a>
                            </div>
                        </td>
                        <td class="type">Genes</td>
                        <td class="datetime">6 Aug</td>
                    </tr>
                </tbody>
            </table>
            <div class="btn close green">Restore</div>
            <div class="btn close gray">Cancel</div>
        </div>

        <div class="popup tags" style="width:700px">
            <h2>Choose tags for "Gene list for D. melanogaster from 15 Nov 2012 11:27"</h2>
            <p>Drag &amp; drop the tags to apply them to the list.</p>

            <div id="set-tags" class="box first clearafter">
                <div class="fifty">
                    <h3>Available tags</h3>

                    <div class="tags available clearafter">
                        <ul class="drag">
                            <li>
                                <a class="public">
                                    <span class="label">public</span>
                                    <span class="description">The list will be displayed to all FlyMine users</span>
                                    <span class="remove">x</span>
                                </a>
                            </li>
                            <li>
                                <a>
                                    <span class="label">im:special</span>
                                    <span class="remove">x</span>
                                </a>
                            </li>
                            <li>
                                <a>
                                    <span class="label">order 3</span>
                                    <span class="description">The list will be ordered</span>
                                    <span class="remove">x</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="fifty">
                    <div class="dropzone" style="width:312px;">
                        <span class="nfo">Drop tags here</span>

                        <div class="tags">
                            <ul>
                                <li>
                                    <a class="private">
                                        <span class="label">admin</span>
                                        <span class="description">No one can delete this list</span>
                                        <span class="remove">x</span>
                                    </a>
                                </li>
                                <li>
                                    <a>
                                        <span class="label">frontpage</span>
                                        <span class="description">This list will show up on FlyMine homepage</span>
                                        <span class="remove">x</span>
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <div id="add-new-tag" class="box">
                <h3>Add a new tag</h3>
                <p class="warning"></p>
                <input type="text" style="display:inline;" />
                <div class="btn add gray">Add</div>
            </div>

            <div class="btn close green">Save</div>
            <div class="btn close gray">Cancel</div>
        </div>
    </div>

    <script type="text/javascript">
    (function() {
        // selected status
        (function() {
            // onload
            $('table tbody tr input[type="checkbox"]:checked').closest('tr').addClass('selected');
            // how many lists are already selected
            var selected = $('table tbody tr.selected').length;
            updateToolbar();
            // on checkbox click
            $('table tbody tr input[type="checkbox"]').click(function(e) {
                if (! $(this).is(':checked')) {
                    $(this).closest('tr').removeClass('selected');
                    selected--;
                } else {
                    $(this).closest('tr').addClass('selected');
                    selected++;
                }
                updateToolbar();
                e.stopPropagation();
            });
            // on row select
            $('table tbody tr').click(function() {
                if (! $(this).hasClass('selected')) {
                    $(this).addClass('selected').find('input[type="checkbox"]').attr('checked','checked');
                    selected++;
                    updateToolbar();
                }
            });

            // create folder/organize switch
            function updateToolbar() {
                if (selected > 0) {
                    // organize lists
                    $('div.toolbar div.btn.folder').hide();
                    $('div.toolbar div.btn.organize').show();
                } else {
                    // create folder
                    $('div.toolbar div.btn.folder').show();
                    $('div.toolbar div.btn.organize').hide();
                }
            }
        })();

        // popup boxes
        (function() {
            $('div.toolbar div.btn').click(function() {
                $('#body-overlay').show();
                $('#body-overlay div.popup.' + $(this).attr('class').split(/\s+/)[1]).show();

                // close button
                $('#body-overlay div.btn.close').click(function() {
                    $('#body-overlay').hide().find('div.popup').hide();
                });
                // esc keypress
                $(document).keyup(function(e) {
                    if (e.keyCode == 27) {
                        $('#body-overlay').hide().find('div.popup').hide();
                    }
                });
            });

            // tagging
            (function() {
                // grab tags in the "system"
                var availableTags = {};
                $('#set-tags div.tags ul li').each(function() {
                    var text = $(this).find('span.label').text();
                    if (text && !availableTags[text]) {
                        availableTags[text] = true;
                    }
                })

                var settings = {
                    'cursor': 'move',
                    'opacity': 0.5,
                    'revert': true,
                    'containment': '#set-tags'
                }

                // drag & drop of tags
                $('ul.drag li').draggable(settings);
                $('div.dropzone').droppable({
                    'accept': 'ul.drag li',
                    'drop': function(event, ui) {
                        ui.draggable.appendTo('div.dropzone div.tags ul')
                        .attr('style', 'left:0;top:0;')
                        .draggable('option', 'disabled', true)
                        .draggable('option', 'revert', false);
                    }
                });

                // removal of tags
                function removeTag(element) {
                    $(element).closest('li').appendTo('div.tags.available ul')
                    .attr('style', 'position:relative')
                    .draggable(settings)
                    .draggable('option', 'disabled', false);
                }
                $('div.tags ul li a span.remove').click(function() {
                    removeTag(this);
                });

                // create a new tag
                function addNewTag() {
                    var label = $('#add-new-tag input').val();
                    if (label) {
                        if (!availableTags[label]) {
                            $('<li/>', {
                                'html': function() {
                                   return $('<a/>')
                                   .append($('<span/>', {
                                       'class': 'label',
                                       'text': label
                                   }))
                                   .append($('<span/>', {
                                       'class': 'remove',
                                       'text': 'x'
                                   }))
                                }
                            })
                            .appendTo('#set-tags div.dropzone div.tags ul')
                            .click(function() {
                                removeTag(this);
                            });

                            availableTags[label] = true;
                            $('#add-new-tag p.warning').html('');

                            $('#add-new-tag input').val('')
                        } else {
                            $('#add-new-tag p.warning').text('Wowza! That one already exists.')
                        }
                    }                    
                }
                $('#add-new-tag input').keydown(function(e) {
                    if (e.keyCode == 13) {
                        addNewTag();
                    }
                });
                $('#add-new-tag div.btn.add').click(function() {
                    addNewTag();
                });
            })();
        })();
    })();
    </script>
</body>
</html>